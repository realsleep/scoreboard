<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Scoreboard</title>
    <style>
        html,
        body {
            height: 100%;
        }
    </style>
    <link href="bootstrap.min.css" rel="stylesheet" />
    <link rel="manifest" href="manifest.json" />
</head>

<body>

    <nav class="navbar navbar-dark bg-dark">
        <div class="container-fluid">
            <span class="navbar-brand mb-0 h1">Scoreboard</span>
        </div>
    </nav>
    <table class="table">
        <thead>
            <tr>
                <th scope="col">#</th>
                <th scope="col">Team 1</th>
                <th scope="col">Team 2</th>
                <th scope="col">Start/Winner</th>
            </tr>
        </thead>
        <tbody id="center">
        </tbody>
    </table>
    <div class="container absolute bottom mt-4">
        <div class="row">
            <div class="col">
                <button type="submit" class="btn btn-primary w-100" formaction="/" formmethod="get">Reset</button>
            </div>
        </div>
    </div>
    <script>
        fetch('/matches')
            .then((response) => response.json())
            .then((data) => {
                for (let i = 0; i < data.length; i++) {
                    var tr = document.createElement('tr');
                    var th = document.createElement('th');
                    th.scope = 'row';
                    th.innerText = i + 1;
                    var name1_td = document.createElement('td');
                    name1_td.innerText = data['MATCH' + i][0]
                    var name2_td = document.createElement('td');
                    name2_td.innerText = data['MATCH' + i][1]

                    tr.appendChild(th);
                    tr.appendChild(name1_td);
                    tr.appendChild(name2_td);

                    if (data['MATCH' + i + 'WIN']) {
                        var winner = document.createElement('td');
                        winner.innerText = data['MATCH' + i + 'WIN']
                        tr.appendChild(winner);
                    } else {
                        var td = document.createElement('td');
                        var form = document.createElement('form');
                        form.className = 'p-2 h-100';
                        var btn = document.createElement('button');
                        btn.type = 'submit';
                        btn.className = 'btn btn-primary w-100';
                        btn.formAction = '/start_match'
                        btn.formMethod = 'get'
                        btn.innerText = 'Start'
                        form.appendChild(btn);
                        var input = document.createElement('input');
                        input.type = 'hidden'
                        input.name = 'id';
                        input.value = i + 1;
                        form.appendChild(input)
                        td.appendChild(form)
                        tr.appendChild(td);
                    }

                    document.getElementById("center").appendChild(tr);
                }
            });
    </script>
</body>

</html>